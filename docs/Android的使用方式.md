# Android的使用方式

## 使用系统原生代理功能

### 局限性

根据系统版本和厂商魔改情况，可能内置代理无法使用socks5代理。这时只能使用http代理。

但是目前vproxy仅支持http tunnel模式，也就是connect方法。所以http请求无法进行代理，https正常。  
你也可以正常使用http请求，不会受到任何影响，只是不提供翻墙而已。

大多数国外app都使用https访问，正常使用时，在地址栏输入`https://`开头的url，也可以实现翻墙。

### agent配置需求

* `agent.httpconnect.listen`必须设置
* `agent.gateway`设置为`on`

### Android配置

1. 进入wifi设置页面
2. 长按你连接的wifi名称，选择“修改网络”
3. 点击“显示高级选项”
4. 代理一栏选择“自动”
5. PAC网址中输入agent相关地址

这里举个例子：

比如运行agent的机子ip地址是192.168.1.2，配置文件中agent.gateway.pac.address写了\*:20080。
那么这里需要填写：http://192.168.1.2:20080/

到此，配置就已经完成了。

## 配合第三方app

根据系统版本和各厂商阉割功能多少，原生代理可能有少数限制。如果要配合第三方app使用，这里推荐使用[Postern](https://play.google.com/store/apps/details?id=com.tunnelworkshop.postern)。

Postern中可以配置代理地址、转发规则，配置完成后点击“打开VPN”即可实现代理。不需要root权限。但是app可能会被系统杀掉。

### agent配置需求

* `agent.gateway`设置为`on`

### Android配置

1. 安装Postern，打开该app
2. 左上角有一个菜单栏按钮（几条横杠），点击后可以弹出菜单
3. 选择菜单中的“配置代理”。然后点击界面中的“添加代理服务器”
4. 在“服务器名称”中随便输入一个名字，比如`myproxy`
5. “服务器地址”输入局域网内部署了agent机器的地址
6. “服务器端口”输入agent监听的端口
7. “代理类型”选择SOCKS5
8. 用户名和密码留空，然后点击“保存”
9. 选择菜单中的“配置规则”。然后点击界面中的“添加规则”
10. “匹配类型”选择“匹配所有地址”
11. “动作”选择“通过代理连接”
12. “代理/代理组”选择刚才你设置的代理
13. “开启抓包”可以不勾选，“目标地址”保持原样
14. 点击“保存”
15. 点击菜单中的“打开VPN”。这时顶部状态栏会显示一个锁图标表示代理已经成功开启。
